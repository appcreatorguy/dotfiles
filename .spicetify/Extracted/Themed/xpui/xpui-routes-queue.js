"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[727],{70369:(e,t,a)=>{a.d(t,{$:()=>r.$});var r=a(22578)},8416:(e,t,a)=>{a.r(t),a.d(t,{QueueHistoryRoutes:()=>Pe,default:()=>Ie});var r=a(67294),n=a.n(r),l=a(73305),i=a(61377),s=a(9832),u=a(73012),c=a(96685),o=a(20657),m=a(76343),d=a(31);const p="atsVsq_V4TOEd6m8v4dy",E="rUaDGpvrpIlwpDrPRQbL",g="l9_FyRGTEmDOyjWBmHiZ",v=()=>n().createElement("div",{className:p},n().createElement(d.l,{iconSize:64}),n().createElement(m.Dy.h1,{variant:c.LF.alto,color:u.$_Y.white,className:E},o.ag.get("history.empty-title")),n().createElement("p",null,o.ag.get("history.empty-description")));var y=a(69518),b=a.n(y),f=a(42922),h=a(59713),O=a.n(h),k=a(25237),w=a(80624);function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){O()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const C=[];function D(e,t=!0){const[a,n]=(0,r.useState)({});return(0,r.useEffect)((()=>{if(!t)return;const r=Array.from(new Set(e)),l=r.filter((e=>b().isTrack(e)&&!a[e])),i=r.filter((e=>b().isEpisode(e)&&!a[e])),s=l.length?k.fQ.getTracks(w.b.getInstance(),l.map((e=>b().from(e).getBase62Id()))).then((e=>e.body.tracks||C)):Promise.resolve(C),u=i.map((e=>k.UY.getEpisodeGraphQL(w.b.getInstance(),b().from(e).getBase62Id()).then((e=>(null==e?void 0:e.body)||{})).catch((t=>(console.error(t),{uri:e})))));Promise.all([s,...u]).then((([e,...t])=>{const a={},r={};e.forEach((e=>{var t;a[(null==e||null===(t=e.linked_from)||void 0===t?void 0:t.uri)||e.uri]=e})),t.forEach((e=>{r[e.uri]=e})),(e.length>0||t.length>0)&&n((e=>x(x(x({},e),a),r)))}))}),[e,a,t]),e.map((e=>a[e]))}var P=a(42781),I=a(49961),q=a(47991),L=a(28248),S=a(78041);const U=n().memo((({items:e})=>{const t=D(e.map((e=>e.uri))),a=(0,r.useMemo)((()=>t.map(((t,a)=>e[a].isLocal?e[a]:t))),[t,e]),l=(0,r.useCallback)(((e,t)=>{if((r=e).type===P.p.TRACK&&b().isTrack(r.uri)){var a;const r=(0,I.X)(null===(a=e.album)||void 0===a?void 0:a.images,{desiredSize:40});return n().createElement(S.Lk,{key:t+e.uri,index:t,uri:(0,q.$V)(e),name:e.name,duration_ms:e.duration_ms,imgUrl:(null==r?void 0:r.url)||"",album:e.album,artists:e.artists,isExplicit:e.explicit,isMOGEFRestricted:(e.tags||[]).includes("MOGEF-19+")})}var r,l,i;if((e=>e.type===P.p.EPISODE)(e)){var s;const a=(0,I.X)(null===(s=e.show)||void 0===s?void 0:s.images,{desiredSize:40});return n().createElement(S.Lk,{key:t+e.uri,index:t,uri:(0,q.$V)(e),name:e.name,duration_ms:e.duration_ms,imgUrl:(null==a?void 0:a.url)||"",album:{name:e.show.name,uri:e.show.uri},artists:[{name:e.show.publisher,uri:""}],isExplicit:e.explicit,isMOGEFRestricted:!1})}return(e=>e.type===P.p.TRACK&&b().isLocalTrack(e.uri))(e)?n().createElement(S.Lk,{key:t+e.uri,index:t,uri:e.uri,name:e.name,duration_ms:e.duration,imgUrl:e.imageUrl||"",album:{name:(null===(l=e.album)||void 0===l?void 0:l.name)||"",uri:""},artists:[{name:(null===(i=e.artist)||void 0===i?void 0:i.name)||"",uri:""}],isExplicit:e.isExplicit,isMOGEFRestricted:!1}):n().createElement(L.hU,{height:`${L.dN}px`})}),[]),i=(0,r.useMemo)((()=>[L.QD.TITLE,L.QD.ALBUM_OR_PODCAST,L.QD.DURATION]),[]),s=(0,r.useCallback)((e=>e.uri),[]);return n().createElement(n().Fragment,null,n().createElement(f.ZP,{value:"play-history-tracklist"},n().createElement(L.Pv,{ariaLabel:"play-history",hasHeaderRow:!0,columns:i,renderRow:l,resolveUri:s,tracks:a,nrTracks:a.length,rowPlaceholder:L.hU,limit:50})))})),j="lKD15PN9kUzmXgvbqyku",F="QyHCIHEiCu2GI4iwPEiv",_=()=>{const e=(0,s.U5)();return e&&e.items.length>0?n().createElement("div",{className:j},n().createElement(m.Dy.h1,{variant:c.LF.canon,color:u.$_Y.white,className:F},o.ag.get("view.recently-played")),n().createElement(U,{items:e.items})):n().createElement(v,null)};var T=a(94184),A=a.n(T),Q=a(23716),R=a(84242),G=a(34891),$=a(86081);var B=a(14472),M=a(70369),Y=a(67892),V=a(62890);const z="vPcEtsKAuDcjwDdk6DVI",K=({onClick:e})=>n().createElement(V.z,{className:z,version:"outlined",onClick:e,title:o.ag.get("queue.clear-queue")},n().createElement(m.Dy,{variant:c.LF.minuetBold},o.ag.get("queue.clear-queue")));var W=a(21770),H=a(99450),X=a(16229),Z=a(18061),J=a(8247),ee=a(85105);const te="ekxwDBqjmLy3ViXWVZAm",ae="ecu2GBw9UEtlqvmNtWqQ",re="K4EGJOvv5EFhspqNNTbN",ne="WSOVmnq4TEJc21APfUsw",le="gNHB91piJ8hkdioBOTb6",ie=n().memo((({onClose:e,onConfirm:t,isOpen:a,itemCount:l})=>{const i=(0,r.useCallback)((a=>{t(),e(a)}),[t,e]),s=o.ag.get("queue.confirm-title",l);return n().createElement(ee.Z,{shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,onRequestClose:e,contentLabel:s,isOpen:a},n().createElement("div",{className:te},n().createElement(m.Dy,{as:"h2",variant:c.LF.cello,className:ae},s),n().createElement(m.Dy,{as:"p",variant:c.LF.mesto,className:re},o.ag.get("queue.confirm-message")),n().createElement("div",{className:ne},n().createElement(Z.F,{property:J.iY,renderOldExperience:()=>n().createElement(X.Y,{className:le,version:"tertiary",onClick:e},o.ag.get("queue.cancel-button")),renderNewExperience:()=>n().createElement(W.oM,{onClick:e},o.ag.get("queue.cancel-button"))}),n().createElement(Z.F,{property:J.iY,renderOldExperience:()=>n().createElement(X.Y,{version:"primary",onClick:i},o.ag.get("queue.confirm-button")),renderNewExperience:()=>n().createElement(H.D,{onClick:i},o.ag.get("queue.confirm-button"))}))))}));var se=a(40160),ue=a(83993);const ce=()=>n().createElement("div",{className:p},n().createElement(ue.j,{iconSize:64}),n().createElement(m.Dy.h1,{variant:c.LF.alto,color:u.$_Y.white,className:E},o.ag.get("queue.empty-title")),n().createElement("p",null,o.ag.get("queue.empty-description")),n().createElement(se.OL,{to:"/search",className:g},n().createElement(X.Y,{version:"secondary"},o.ag.get("queue.fine-something"))));var oe=a(11956),me=a(99995),de=a(56802);function pe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ee(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(a),!0).forEach((function(t){O()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const ge=(e,t)=>{const a=D(e.slice(0,50).map((e=>e.uri)),t);return t?e.reduce(((e,t,r)=>(a[r]&&e.push(((e,t)=>(0,me.G_)(e)&&(e=>"track"===e.type)(t)?Ee(Ee({},e),{},{name:t.name,album:Ee(Ee({},e.album),{},{name:t.album.name,images:t.album.images,uri:t.album.uri}),artists:t.artists.map((e=>({name:e.name,uri:e.uri,type:P.p.ARTIST}))),duration:{milliseconds:t.duration_ms},isExplicit:t.explicit,is19PlusOnly:(t.tags||[]).includes("MOGEF-19+")}):(0,me.iw)(e)&&(e=>"episode"===e.type)(t)?Ee(Ee({},e),{},{name:t.name,show:Ee(Ee({},e.show),{},{name:t.show.name,images:t.show.images,uri:t.show.uri}),duration:{milliseconds:t.duration_ms}}):e)(t,a[r])),e)),[]):e},ve=n().memo((({tracks:e,ariaLabel:t,contextUri:a,rowNumberOffset:l=0,section:i,usePlayContextItem:s})=>{const u=(0,de.o)(),c=(0,Q.g)(),o=ge(e,!c.getCapabilities().hasDecoratedQueue),m=(0,r.useCallback)(((e,t)=>{u({intent:"remove-from-queue",type:"click"}),c.removeFromQueue(e.map((e=>({uid:e.id,uri:e.uri})))).then(t)}),[c,u]),d=(0,r.useCallback)(((e,t)=>{if((0,me.iw)(e)){var r,u;const c=(0,I.X)(null===(r=e.show)||void 0===r?void 0:r.images,{desiredSize:40});return n().createElement(L.pD,{key:`${t}${l}${e.uid}`,index:t,rowNumberOffset:l,imgUrl:(null==c?void 0:c.url)||"",uri:(0,q.$V)(e),uid:null!==(u=e.uid)&&void 0!==u?u:e.uri,contextUri:a,duration_ms:e.duration.milliseconds,name:e.name,artists:[],album:{name:e.show.name,uri:e.show.uri},isExplicit:!1,isPlayable:!0,isMOGEFRestricted:!1,type:L.jO.EPISODE,section:i,usePlayContextItem:s,isAutoPlay:"autoplay"===e.provider})}if((0,me.G7)(e)){var c;const r=(0,I.X)(e.images||void 0,{desiredSize:40});return n().createElement(L.pD,{key:`${t}${l}${e.uid}`,index:t,rowNumberOffset:l,imgUrl:(null==r?void 0:r.url)||"",uri:(0,q.$V)(e),uid:null!==(c=e.uid)&&void 0!==c?c:e.uri,contextUri:a,duration_ms:e.duration.milliseconds,name:e.name,artists:[],album:{name:e.book.name,uri:e.book.uri},isExplicit:!1,isPlayable:!0,isMOGEFRestricted:!1,type:L.jO.CHAPTER,section:i,usePlayContextItem:s,isAutoPlay:"autoplay"===e.provider})}if((0,me.G_)(e)){var o,m,d,p;const r=(0,I.X)(null==e||null===(o=e.album)||void 0===o?void 0:o.images,{desiredSize:40});return n().createElement(L.pD,{key:`${t}${l}${e.uid}`,index:t,rowNumberOffset:l,imgUrl:(null==r?void 0:r.url)||"",uri:(0,q.$V)(e),uid:null!==(m=e.uid)&&void 0!==m?m:e.uri,contextUri:a,duration_ms:e.duration.milliseconds,name:e.name,artists:e.artists,album:e.album,isExplicit:null!==(d=e.isExplicit)&&void 0!==d&&d,isPlayable:!0,isMOGEFRestricted:null!==(p=e.is19PlusOnly)&&void 0!==p&&p,type:e.isLocal?L.jO.LOCAL:L.jO.TRACK,section:i,usePlayContextItem:s,isAutoPlay:"autoplay"===e.provider})}return n().createElement(L.Lb,{height:`${L.dN}px`})}),[l,a,i,s]),p=(0,r.useMemo)((()=>[L.QD.INDEX,L.QD.TITLE,L.QD.ALBUM,L.QD.DURATION]),[]),E=(0,r.useCallback)((e=>e.uri),[]),g=(0,r.useCallback)((e=>{var t;return null!==(t=e.uid)&&void 0!==t?t:e.uri}),[]);return o&&n().createElement(L.Pv,{ariaLabel:t,tracks:o,nrTracks:o.length,onRemove:m,renderRow:d,resolveUri:E,resolveUid:g,columns:p})})),ye="j9gyOcTuf365d_rG7ack",be="hwrIbokMLNi_FwQfqYcX",fe="OSrSKCORKBO4JZclYmQ5",he="cTyAlv13Ivw6nbqmJ3rI",Oe="EfpNdSaTi80IzFTHBH66",ke=()=>{const{uri:e,description:t}=(0,B.$)(),a=(0,Q.g)(),{current:l,nextUp:i,queued:s}=function(){const e=(0,Q.g)(),[t,a]=(0,r.useState)(e.getQueue());return(0,$.G)(G.rg.QUEUE_UPDATE,(e=>a(e.data))),t}(),[d,p]=(0,r.useState)(!1),E=(0,r.useCallback)((()=>{p(!1)}),[p]),g=(0,r.useCallback)((()=>{a.clearQueue(),p(!1)}),[a]),v=(0,r.useCallback)((()=>{p(!0)}),[p]),{usePlayContextItem:y}=(0,R.n)({uri:null!=e?e:""},{featureIdentifier:"queue"}),b="autoplay"===(null==l?void 0:l.provider),h=i.filter((e=>b?e:"autoplay"!==e.provider)),O=!(null==s||!s.length),k=!(null==h||!h.length);return!1===(l||O||k)?n().createElement(ce,null):n().createElement("section",{className:ye},n().createElement(M.$,null,o.ag.get("queue.page-title")),n().createElement(m.Dy.h1,{variant:c.LF.canon,color:u.$_Y.white,className:be},o.ag.get("playback-control.queue")),l&&e&&n().createElement(n().Fragment,null,n().createElement(m.Dy.h2,{variant:c.LF.balladBold,color:u.$_Y.gray70},o.ag.get("queue.now-playing")),n().createElement(f.ZP,{value:"now-playing"},n().createElement(ve,{ariaLabel:o.ag.get("queue.now-playing"),tracks:[l],contextUri:e,section:oe.h.NowPlaying,usePlayContextItem:y}))),O&&e&&n().createElement(n().Fragment,null,n().createElement("div",{className:A()(Oe,fe)},n().createElement(m.Dy.h2,{variant:c.LF.balladBold,color:u.$_Y.gray70},o.ag.get("queue.next-in-queue")),O&&n().createElement(K,{onClick:v})),n().createElement(f.ZP,{value:"next-in-queue"},n().createElement(ve,{ariaLabel:o.ag.get("queue.next-in-queue"),tracks:s,rowNumberOffset:1,contextUri:"spotify:app:queue:NextInQueue",section:oe.h.NextInQueue,usePlayContextItem:y}))),k&&e&&n().createElement(n().Fragment,null,n().createElement(m.Dy.h2,{variant:c.LF.balladBold,color:u.$_Y.gray70,className:A()(fe,"standalone-ellipsis-one-line")},t&&!b?n().createElement(n().Fragment,null,o.ag.get("queue.next-from")," ",n().createElement(Y.r,{className:he,to:e},t)):o.ag.get("queue.next-up")),n().createElement(f.ZP,{value:"next-up"},n().createElement(ve,{ariaLabel:o.ag.get("queue.next-up"),tracks:h,rowNumberOffset:1+((null==s?void 0:s.length)||0),contextUri:"spotify:app:queue:NextUp",section:oe.h.NextUp,usePlayContextItem:y}))),n().createElement(ie,{itemCount:(null==s?void 0:s.length)||0,isOpen:d,onClose:E,onConfirm:g}))};var we=a(69559),Ne=a(9746),xe=a(28638);const Ce="VBjBuss7tKOa3VZ_3tQI",De=()=>{const[e,t]=(0,r.useState)(window.innerWidth);(0,we.a)((()=>{t(window.innerWidth)}));const a=(0,r.useMemo)((()=>[{title:o.ag.get("playback-control.queue"),itemId:"queue",to:"/queue",uri:"spotify:app:queue"},{title:o.ag.get("view.recently-played"),itemId:"history",to:"/history",uri:"spotify:app:history"}]),[]);return n().createElement(xe.w,null,n().createElement(Ne.n,{className:Ce,links:a,windowSize:e}))},Pe=()=>{const e=(0,s.nF)();return n().createElement("section",{className:"contentSpacing"},e&&n().createElement(i.N,{path:"/history",pageId:l.W.NOWPLAYING_HISTORY},n().createElement(_,null)),n().createElement(i.N,{path:"/queue",pageId:l.W.NOWPLAYING_QUEUE},n().createElement(r.Suspense,{fallback:null},n().createElement(ke,null))),e&&n().createElement(De,null))},Ie=Pe},9746:(e,t,a)=>{a.d(t,{n:()=>D});var r=a(67294),n=a.n(r),l=a(94184),i=a.n(l),s=a(96685),u=a(26115),c=a(74594),o=a(20657),m=a(32626),d=a(76343),p=a(43031),E=a(30005),g=a(21691);const v="BkpKedcdaMGbvgXMlmcg",y="muYk5XIwKmqR9iNibk_f",b="queue-tabBar-header",f="m20ShRDiGGDpJ5LSABTi",h="Hvv0e7WKQ4kyftgSQJhg",O="yxf_6IsQEmHjijEBUMTP",k="oaNVBli46GtVjaQKB15g",w="JdlKTdpMquftpMwwegZo",N="Nts_ArOCGeROTDZND3M6",x="FvDsfgxSvLvL3q8d7nQv",C=({items:e,activeItemId:t,setActiveDropdownItem:a})=>n().createElement(E.v,null,e.map((e=>n().createElement(g.s,{key:e.to,role:"menuitemradio",to:e.to,exact:!0,"aria-checked":e.itemId===t,className:O,activeClassName:k,isActive:t=>!!t&&(a(e),!0),onClick:()=>{var t;null===(t=e.handleClick)||void 0===t||t.call(e),a(e)}},e.title)))),D=n().memo((({isCentered:e,links:t,landmarkLabel:a,className:l,windowSize:E=1/0})=>{const[g,O]=(0,r.useState)(null),D=(0,r.useRef)(null),[P,I]=(0,r.useState)([]),[q,L]=(0,r.useState)(0),[S,U]=(0,r.useState)([]);(0,r.useEffect)((()=>{D.current&&L(D.current.clientWidth)}),[E]),(0,r.useEffect)((()=>{if(!D.current)return;const e=Array.from(D.current.children).map((e=>e.clientWidth));I(e)}),[t]),(0,r.useEffect)((()=>{if(!D.current)return;if(P.slice(0,-1).reduce(((e,t)=>e+t),0)<=q)return void U([]);const e=P.reduce(((e,t)=>e>t?e:t),0),t=[];let a=e;P.forEach(((e,r)=>{q>=a+e?a+=e:t.push(r)})),U(t)}),[q,P]);const j=(0,r.useCallback)((e=>!!e&&(O(null),!0)),[]);return n().createElement("nav",{className:i()(l,v),"aria-label":a},n().createElement("ul",{className:e?y:N,ref:D},t.filter(((e,t)=>!S.includes(t))).map((e=>n().createElement("li",{key:e.to,className:b},n().createElement(p.O,{exact:!0,className:w,activeClassName:k,to:e.to,isActive:j,onClick:e.handleClick},n().createElement(d.Dy,{variant:s.LF.mestoBold},e.title))))),S.length||0===P.length?n().createElement("li",{className:b},n().createElement(m.xV,{renderInline:!0,menu:n().createElement(C,{items:t.filter(((e,t)=>S.includes(t))),activeItemId:null==g?void 0:g.itemId,setActiveDropdownItem:O})},((e,t,a)=>n().createElement("button",{className:i()(f,{[h]:g}),type:"button",onClick:t,ref:a},n().createElement(d.Dy,{as:"span",variant:s.LF.mestoBold},g?g.title:o.ag.get("more")),e?n().createElement(u.q,{iconSize:16,className:x}):n().createElement(c.m,{iconSize:16,className:x}))))):null))}))}}]);
//# sourceMappingURL=xpui-routes-queue.js.map